In this section, we will be handling form processing or form submission in order to search for an activity from http://toscrape.com (ViewState). ViewState is an AJAX-based filter form.

This particular form submission is performed in multiple steps with the help of [AJAX](https://www.w3schools.com/js/js_ajax_intro.asp). 

Let's set up the code. The pyquery and requests libraries need to be imported and the required URLs need to be collected so that they can be used. The processRequests() function, along with positional and named arguments, is used for processing requests to the provided url, with the HTTP POST and GET methods based on the params argument returning a PyQuery object as a response.

We are also interested in iterating authorTags and collecting the quoteAuthor and message, respectively. In a similar way, any information that's obtained from a page can be extracted:

```
from pyquery import PyQuery as pq
import requests
mainurl = "http://toscrape.com/"
searchurl = "http://quotes.toscrape.com/search.aspx"
filterurl = "http://quotes.toscrape.com/filter.aspx"
quoteurl = "http://quotes.toscrape.com/"
authorTags = [('Albert Einstein', 'success'), ('Thomas A. Edison', 'inspirational')]

def processRequests(url, params={}, customheaders={}):
    if len(params) > 0:
        response = requests.post(url, data=params, headers=customheaders)
    else:
        response = requests.get(url)
    return pq(response.text)

if __name__ == '__main__':
    for authorTag in authorTags:
        authorName,tagName= authorTag
```

The following screenshot displays the content of the searchurl page, as defined in the preceding code. Two separate drop-downs exist, each with options for the author and their tags, respectively:

Let's load searchurl, as shown in the following code, and select an author from the Author drop-down. The `<option>` tag is generated using AJAX for the selected `<option>` of the Author:

```
#Step 1: load searchURL
searchResponse = processRequests(searchurl)
author = searchResponse.find('select#author option:contains("' + authorName + '")').attr('value')
viewstate = searchResponse.find('input#__VIEWSTATE').attr('value')
tag = searchResponse.find('select#tag option').text()

print("Author: ", author)
print("ViewState: ", viewstate)
print("Tag: ", tag)
```

As you can see, the processRequests() function is called using an HTTP GET to searchurl and will be returning a response as an object of PyQuery. From searchResponse, let's collect the necessary form fields. Fields such as author, viewstate, and tag are collected.


`ViewState` is a unique and random value that's generated by websites to identify individual states of the page, which are often found as a hidden `<input>` value. This `<form>` value exists in most websites that use `<form>` and built-in ASP or ASP.NET technologies. The ViewState value is used on the client side, and it preserves or retains the value of the `<form>` elements, alongside page identity. Use of ViewState is one of the techniques related to state management. 

The value of ViewState is compulsory for obtaining the `<option>` tag for the selected Author. As we can see in the following code, params is created with author, tag, and __VIEWSTATE, and is posted or submitted to filterurl using HTTP POST and customheaders by obtaining filterResponse. The following code shows what happens when filterurl has been loaded with the author and default tag:

```
#Step 2: load filterurl with author and default tag
params = {'author': author, 'tag': tag, '__VIEWSTATE': viewstate}
customheaders = {
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
    'Content-Type': 'application/x-www-form-urlencoded',
    'Referer': searchurl
}

filterResponse = processRequests(filterurl,params,customheaders)
viewstate = filterResponse.find('input#__VIEWSTATE').attr('value')
tagSuccess = filterResponse.find('select#tag option:contains("' + tagName + '")').attr('value')
submitButton = filterResponse.find('input[name="submit_button"]').attr('value')

print("Author: ", author)
print("ViewState: ", viewstate)
print("Tag: ", tagSuccess)
print("Submit: ", submitButton)
```

